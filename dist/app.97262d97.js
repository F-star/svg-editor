(()=>{"use strict";var t,e=function(){function t(t,e,n,o){"object"==typeof t?(this.x=t.x,this.y=t.y,this.w=t.width,this.h=t.height):(this.x=t,this.y=e,this.w=n,this.h=o),this.width=this.w,this.height=this.h,this.x2=this.x+this.w,this.y2=this.y+this.h}return t.prototype.contains=function(t){return this.x<=t.x&&this.y<=t.y&&this.x2>=t.x+t.width&&this.y2>=t.y+t.height},t.prototype.merge=function(e){var n=Math.min(this.x,e.x),o=Math.min(this.y,e.y);return new t(n,o,Math.max(this.x2,e.x2)-n,Math.max(this.y2,e.y2)-o)},t}(),n="http://www.w3.org/2000/svg",o=function(){function t(){this.el_=null}return t.prototype.el=function(){return this.el_},t.prototype.setAttr=function(t,e){return this.el_.setAttribute(t,e)},t.prototype.getAttr=function(t){return this.el_.getAttribute(t)},t.prototype.removeAttr=function(t){this.el_.removeAttribute(t)},t.prototype.getBBox=function(){return this.el_.getBBox()},t.prototype.remove=function(){return this.el_.remove()},t.prototype.equal=function(t){return t.el&&(t=t.el()),this.el_===t},t.prototype.parent=function(){var t=this.el_.parentElement;if(t instanceof SVGElement)return l.create(t);throw new Error("parent is not SVGElement")},t.prototype.nextSibling=function(){var t=this.el_.nextElementSibling;return null===t?null:l.create(t)},t.prototype.previousSibling=function(){var t=this.el_.previousElementSibling;return null===t?null:l.create(t)},t.prototype.append=function(t){this.el_.appendChild(t.el())},t.prototype.front=function(){this.el_.parentElement.appendChild(this.el_)},t.prototype.back=function(){var t=this.el_.parentElement,e=t.firstElementChild;e&&t.insertBefore(this.el_,e)},t.prototype.forward=function(){var t=this.el_.parentElement,e=this.el_.nextSibling;e&&t.insertBefore(e,this.el_)},t.prototype.backward=function(){var t=this.el_.previousElementSibling;t&&this.before(t)},t.prototype.before=function(t){t.el&&(t=t.el()),t.parentElement.insertBefore(this.el_,t)},t.prototype.after=function(t){t.el&&(t=t.el());var e=t.parentElement,n=t.nextSibling;n?e.insertBefore(this.el_,n):e.appendChild(this.el_)},t.prototype.getPos=function(){return{x:parseFloat(this.getAttr("x")),y:parseFloat(this.getAttr("y"))}},t.prototype.dmove=function(t,e){var n=this.getPos();this.setAttr("x",n.x+t+""),this.setAttr("y",n.y+e+"")},t.prototype.hide=function(){this.el_.style.display="none"},t.prototype.visible=function(){this.el_.removeAttribute("style")},t}(),r=(t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)},function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}),i=function(t){function e(e,o,r,i){var s=t.call(this)||this;return"object"==typeof e?s.el_=e:(s.el_=document.createElementNS(n,"rect"),s.setAttr("x",e+""),s.setAttr("y",o+""),s.setAttr("width",r+""),s.setAttr("height",i+"")),s}return r(e,t),e.prototype.setPos=function(t,e){this.setAttr("x",String(t)),this.setAttr("y",String(e))},e.prototype.setCenterPos=function(t,e){var n=parseFloat(this.getAttr("width")),o=parseFloat(this.getAttr("height"));this.setPos(t-n/2,e-o/2)},e}(o),s=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),a=function(t){function e(e){var o=t.call(this)||this;return o.el_=e||document.createElementNS(n,"g"),o}return s(e,t),e}(o),h=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),u=function(t){function e(e){var o=t.call(this)||this;return o.el_=e||document.createElementNS(n,"path"),o}return h(e,t),e.prototype.dmove=function(t,e){var n,o=this.getAttr("d"),r=t;this.setAttr("d",o.replace(/\s+(-?[\d.]+)/g,(function(o,i){return n=" "+(parseFloat(i)+r),r=r===t?e:t,n})))},e}(o),c=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();var l={create:function(t){var e=t.tagName;if("rect"===e)return new l.Rect(t);if("g"===e)return new l.Group(t);if("path"===e)return new l.Path(t);throw new Error("Can not creat "+e+" instance, no match class.")},Rect:i,Box:e,Group:a,Path:u,Line:function(t){function e(e,o,r,i){var s=t.call(this)||this;return"object"==typeof e?s.el_=e:(s.el_=document.createElementNS(n,"line"),s.setAttr("x1",String(e)),s.setAttr("y1",String(o)),s.setAttr("x2",String(r)),s.setAttr("y2",String(i))),s}return c(e,t),e.prototype.setPos=function(t,e,n,o){this.setAttr("x1",String(t)),this.setAttr("y1",String(e)),this.setAttr("x2",String(n)),this.setAttr("y2",String(o))},e}(o)};var p=function(){function t(t){this.editor=t,this.els=[]}return t.prototype.setEls=function(t){Array.isArray(t)||(t=[t]),this.els=t,this.heighligthEls(),this.setSetting("fill"),this.setSetting("stroke"),this.setSetting("stroke-width")},t.prototype.getEls=function(){return this.els},t.prototype.setElsInBox=function(t){if(0!==t.width&&0!==t.height){var e=function(t,e){var n=["g"];t=new l.Box(t);var o=[];return function t(e,r){for(var i=r.children,s=0;s<i.length;s++){var a=i[s];if(!n.includes(a.tagName)){var h=a.getBBox();e.contains(h)&&o.push(l.create(a))}a.children.length>0&&t(e,a)}}(t,e),o}(t,this.editor.svgContent);0===e.length?this.clear():this.setEls(e)}else this.clear()},t.prototype.isEmpty=function(){return 0===this.els.length},t.prototype.isNoEmpty=function(){return this.els.length>0},t.prototype.clear=function(){this.els=[],this.editor.hudManager.outlineBoxHud.clear()},t.prototype.contains=function(t){for(var e=0;e<this.els.length;e++)if(this.els[e].el()===t)return!0;return!1},t.prototype.getMergeBBox=function(){},t.prototype.heighligthEls=function(){var t=this.els,e=this.editor.hudManager,n=new l.Box(t[0].getBBox()),o=t.reduce((function(t,e){var n=e.getBBox();return t.merge(new l.Box(n))}),n);e.outlineBoxHud.drawRect(o.x,o.y,o.width,o.height)},t.prototype.setSetting=function(t){var e=this.els.map((function(e){return e.getAttr(t)}));this.editor.setting.set(t,e[0])},t.prototype.setElsAttr=function(t,e){this.isNoEmpty()&&(console.log(t,e),this.editor.executeCommand("setAttr",this.els,t,e))},t}(),d=function(){function t(t){this.x=0,this.y=0,this.w=0,this.h=0,this.x=0,this.y=0,this.w=0,this.h=0,this.container=document.createElementNS(n,"g"),this.container.id="outline-box-hud",t.appendChild(this.container),this.outline=document.createElementNS(n,"path"),this.outline.setAttribute("fill","none"),this.outline.setAttribute("stroke","#f04"),this.outline.setAttribute("vector-effect","non-scaling-stroke"),this.container.appendChild(this.outline)}return t.prototype.clear=function(){this.outline.style.display="none"},t.prototype.drawRect=function(t,e,n,o){this.x=t,this.y=e,this.w=n,this.h=o;var r="M "+t+" "+e+" L "+(t+n)+" "+e+" L "+(t+n)+" "+(e+o)+" L "+t+" "+(e+o)+" Z";this.outline.setAttribute("d",r),this.outline.style.display=""},t.prototype.getWidth=function(){return this.w},t.prototype.getHeight=function(){return this.h},t.prototype.getX=function(){return this.x},t.prototype.getY=function(){return this.y},t}(),f=function(){function t(t){this.x=0,this.y=0,this.w=0,this.h=0,this.container=document.createElementNS(n,"g"),this.container.id="select-area",t.appendChild(this.container),this.outline=document.createElementNS(n,"path"),this.outline.setAttribute("fill","none"),this.outline.setAttribute("stroke","#054"),this.outline.setAttribute("vector-effect","non-scaling-stroke"),this.outline.setAttribute("stroke-dasharray","4px"),this.container.appendChild(this.outline)}return t.prototype.clear=function(){this.x=this.y=this.w=this.h=0,this.outline.style.display="none"},t.prototype.drawRect=function(t,e,n,o){this.x=t,this.y=e,this.w=n,this.h=o;var r="M "+t+" "+e+" L "+(t+n)+" "+e+" L "+(t+n)+" "+(e+o)+" L "+t+" "+(e+o)+" Z";this.outline.setAttribute("d",r),this.outline.style.display=""},t.prototype.getWidth=function(){return this.w},t.prototype.getHeight=function(){return this.h},t.prototype.getX=function(){return this.x},t.prototype.getY=function(){return this.y},t.prototype.getBox=function(){return{x:this.x,y:this.y,width:this.w,height:this.h,w:this.w,h:this.h}},t}(),g=function(){function t(t){this.container=document.createElementNS(n,"g"),this.path=new l.Path,t.appendChild(this.container),this.path.setAttr("fill","none"),this.path.setAttr("stroke","#054"),this.path.setAttr("vector-effect","non-scaling-stroke"),this.container.appendChild(this.path.el())}return t.prototype.addPoint=function(t,e){this.path.visible();var n=this.getD();""===n||null===n?n="M "+t+" "+e:n+=" L "+t+" "+e,this.path.setAttr("d",n)},t.prototype.getD=function(){return this.path.getAttr("d")},t.prototype.clear=function(){this.path.hide(),this.path.removeAttr("d")},t}(),y=(function(){function t(t,e,n,o){this.x=t,this.y=e,this.handleIn=n,this.handleOut=o}t.prototype.getHandleInOrAnchor=function(){return this.handleIn?this.handleIn:{x:this.x,y:this.y}},t.prototype.getHandleOutOrAnchor=function(){return this.handleOut?this.handleOut:{x:this.x,y:this.y}},t.prototype.hasHandleIn=function(){return!!this.handleIn},t.prototype.hasHandleOut=function(){return!!this.handleOut}}(),function(){function t(t){this.container=document.createElementNS(n,"g"),this.container.id="segment-draw",this.path=new l.Path,t.appendChild(this.container),this.path.setAttr("fill","none"),this.path.setAttr("stroke","#f04"),this.path.setAttr("vector-effect","non-scaling-stroke"),this.handleInLine=new l.Line(0,0,0,0),this.handleInLine.setAttr("stroke","#f04"),this.handleInLine.hide(),this.container.appendChild(this.handleInLine.el()),this.handleOutLine=new l.Line(0,0,0,0),this.handleOutLine.setAttr("stroke","#f04"),this.handleOutLine.hide(),this.container.appendChild(this.handleOutLine.el()),this.anchorNode=new l.Rect(0,0,6,6),this.anchorNode.setAttr("stroke","#000"),this.anchorNode.setAttr("fill","#fff"),this.anchorNode.hide(),this.container.appendChild(this.anchorNode.el()),this.handleInNode=new l.Rect(0,0,6,6),this.handleInNode.setAttr("stroke","#000"),this.handleInNode.setAttr("fill","#fff"),this.handleInNode.hide(),this.container.appendChild(this.handleInNode.el()),this.handleOutNode=new l.Rect(0,0,6,6),this.handleOutNode.setAttr("stroke","#000"),this.handleOutNode.setAttr("fill","#fff"),this.handleOutNode.hide(),this.container.appendChild(this.handleOutNode.el())}return t.prototype.render=function(t){this.anchorNode.setCenterPos(t.x,t.y),this.anchorNode.visible(),this.handleInNode.setCenterPos(t.handleIn.x,t.handleIn.y),this.handleInNode.visible(),this.handleOutNode.setCenterPos(t.handleOut.x,t.handleOut.y),this.handleOutNode.visible(),this.handleInLine.setPos(t.x,t.y,t.handleIn.x,t.handleIn.y),this.handleInLine.visible(),this.handleOutLine.setPos(t.x,t.y,t.handleOut.x,t.handleOut.y),this.handleOutLine.visible()},t.prototype.clear=function(){this.path.hide(),this.anchorNode.hide(),this.handleInNode.hide(),this.handleOutNode.hide()},t}()),v=function(){function t(t){this.segs=[],this.container=document.createElementNS(n,"g"),this.container.id="path-draw",this.path=new l.Path,t.appendChild(this.container),this.path.setAttr("fill","none"),this.path.setAttr("stroke","#f04"),this.path.setAttr("vector-effect","non-scaling-stroke"),this.container.appendChild(this.path.el()),this.segDraw=new y(t)}return t.prototype.addSeg=function(t){this.path.visible();var e=this.getD();if(e){var n=this.segs[this.segs.length-1];e+=" C "+(n.handleOut?n.handleOut.x:n.x)+" "+(n.handleOut?n.handleOut.y:n.y)+" "+(t.handleIn?t.handleIn.x:t.x)+" "+(t.handleIn?t.handleIn.y:t.y)+" "+t.x+" "+t.y}else e="M "+t.x+" "+t.y;this.segs.push(t),this.path.setAttr("d",e)},t.prototype.updateTailSegHandle=function(t,e){var n=this.getTailSeg();if(null===n)throw new Error("the path has not segments");n.handleIn=t,n.handleOut=e,this.updateDBySegs(),this.segDraw.render(this.getTailSeg())},t.prototype.updateDBySegs=function(){if(0===this.segs.length)return"";var t,e=this.segs[0];t="M "+e.x+" "+e.y;for(var n=1;n<this.segs.length;n++){var o=this.segs[n],r=o.x,i=o.y,s=o.handleIn,a=s?s.x:r,h=s?s.y:i,u=this.segs[n-1];t+=" C "+(u.handleOut?u.handleOut.x:u.x)+" "+(u.handleOut?u.handleOut.y:u.y)+" "+a+" "+h+" "+r+" "+i}this.path.setAttr("d",t)},t.prototype.getTailSeg=function(){return 0===this.segs.length?null:this.segs[this.segs.length-1]},t.prototype.getD=function(){return this.path.getAttr("d")},t.prototype.clear=function(){this.path.hide(),this.path.removeAttr("d"),this.segs=[]},t}(),m=function(){function t(){this.container=document.createElementNS(n,"g"),this.container.id="huds",this.selectArea=new f(this.container),this.outlineBoxHud=new d(this.container),this.pencilDraw=new g(this.container),this.pathDraw=new v(this.container)}return t.prototype.mount=function(t){t.appendChild(this.container)},t}(),w=function(){function t(t){var e=this;this.editor=t,this.registeredFns={},window.addEventListener("keydown",(function(t){var n=function(t){var e=[];t.ctrlKey&&e.push("Ctrl");t.metaKey&&e.push("Cmd");t.shiftKey&&e.push("Shift");/Key./.test(t.code)?e.push(t.code[t.code.length-1]):e.push(t.code);return e.join("+")}(t),o=e.registeredFns[n];o&&(console.log(n),t.preventDefault(),o.fn(t))}),!1)}return t.prototype.register=function(t,e,n){this.registeredFns[e]={cmdName:t,fn:n}},t.prototype.formatPrint=function(){var t=[];for(var e in this.registeredFns){var n=this.registeredFns[e].cmdName;t.push(n+": "+e)}return t.join(", ")},t}();function x(t){var e=t.getAttribute("viewBox");if(!e)throw new Error("has not viewBox attribute");var n=e.split(/[\s,]+/).map((function(t){return parseFloat(t)}));return{x:n[0],y:n[1],w:n[2],h:n[3]}}var E=function(){function t(t){this.editor=t}return t.prototype.getScroll=function(){return{x:this.editor.svgContainer.scrollLeft,y:this.editor.svgContainer.scrollTop}},t.prototype.setScroll=function(t,e){this.editor.svgContainer.scrollLeft=t,this.editor.svgContainer.scrollTop=e},t.prototype.getContentOffset=function(){return{x:parseFloat(this.editor.svgStage.getAttribute("x")),y:parseFloat(this.editor.svgStage.getAttribute("y"))}},t.prototype.getViewportCenter=function(){return{x:parseFloat(this.editor.svgStage.getAttribute("width"))/2,y:parseFloat(this.editor.svgStage.getAttribute("height"))/2}},t.prototype.getZoom=function(){return parseFloat(this.editor.svgRoot.getAttribute("width"))/x(this.editor.svgRoot).w},t.prototype.setZoom=function(t,e,n){if(void 0===e){var o=this.getViewportCenter();e=o.x,n=o.y}var r=this.getScroll(),i=r.x,s=r.y,a=this.getContentOffset(),h=a.x,u=a.y,c=this.getZoom(),l=(e+h)*t-((e+h)*c-i),p=(n+u)*t-((n+u)*c-s);this.setScroll(l,p);var d=x(this.editor.svgRoot),f=d.w*t,g=d.h*t;this.editor.svgRoot.setAttribute("width",String(f)),this.editor.svgRoot.setAttribute("height",String(g))},t.prototype.zoomIn=function(t,e){var n=this.getZoom();this.setZoom(n+.1,t,e)},t.prototype.zoomOut=function(t,e){var n=this.getZoom();this.setZoom(n-.1,t,e)},t.prototype.center=function(){var t=this.getSVGRootBox("width"),e=this.getSVGRootBox("height"),n=this.getViewportBox("width"),o=this.getViewportBox("height");this.setScroll((t-n)/2,(e-o)/2)},t.prototype.getViewportBox=function(t){return parseFloat(this.editor.viewportElement.style[t])},t.prototype.getSVGRootBox=function(t){return parseFloat(this.editor.svgRoot.getAttribute(t))},t}(),b=function(){function t(){this.i=0}return t.prototype.getId=function(){return this.i++},t}(),S=function(){function t(t,e){this.editor=t,this.el_=document.createElementNS(n,"g"),this.el_.id="layer-"+e}return t.prototype.el=function(){return this.el_},t.prototype.getVisible=function(){},t.prototype.setVisible=function(t){},t.prototype.addChild=function(t){this.el_.appendChild(t.el())},t.prototype.remove=function(){this.el_.remove()},t}(),C=function(){function t(t){this.editor=t,this.currentLayer=null,this.isInit=!1,this.idGenerator=new b}return t.prototype.createInitLayerAndMount=function(){if(this.isInit)throw new Error("Had inited! Don't call this methods again!");var t=this.idGenerator.getId(),e=new S(this.editor,t);this.addLayer(e),this.isInit=!0},t.prototype.setCurrent=function(t){this.currentLayer=t},t.prototype.getCurrent=function(){return this.currentLayer},t.prototype.addLayer=function(t){this.editor.svgContent.appendChild(t.el()),this.currentLayer=t},t.prototype.removeCurrLayer=function(){},t}(),A=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var o=Array(t),r=0;for(e=0;e<n;e++)for(var i=arguments[e],s=0,a=i.length;s<a;s++,r++)o[r]=i[s];return o};const _=function(){function t(){this.setting=null,this.commandManager=null,this.activedElsManager=new p(this),this.shortcut=new w(this),this.toolManager=null,this.viewport=new E(this),this.layerManager=new C(this),this.hudManager=new m;var t=document.createElement("div");t.id="viewportElement",t.style.border="1px solid #000",t.style.width="800px",t.style.height="550px",this.viewportElement=t;var e=document.createElement("div");e.id="svg-container",e.style.backgroundColor="#ddd",e.style.width="800px",e.style.height="550px",e.style.overflow="scroll",this.svgContainer=e;var n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.id="svg-root",n.setAttribute("width","3000"),n.setAttribute("height","1500"),n.setAttribute("viewBox","0 0 3000 1500"),this.svgRoot=n;var o=document.createElementNS("http://www.w3.org/2000/svg","svg");o.id="svg-stage",o.setAttribute("width",String(520)),o.setAttribute("height",String(400)),o.setAttribute("x",String(Math.floor(1240))),o.setAttribute("y",String(Math.floor(550))),o.style.overflow="visible",this.svgStage=o;var r=document.createElementNS("http://www.w3.org/2000/svg","g");r.id="background",r.setAttribute("x","0"),r.setAttribute("y","0");var i=document.createElementNS("http://www.w3.org/2000/svg","rect");i.setAttribute("width","100%"),i.setAttribute("height","100%"),i.setAttribute("fill","#fff");var s=document.createElementNS("http://www.w3.org/2000/svg","g");s.id="content",s.setAttribute("x","0"),s.setAttribute("y","0"),this.svgContent=s,t.appendChild(e),e.appendChild(n),n.appendChild(o),o.appendChild(r),r.appendChild(i),o.appendChild(s),this.layerManager.createInitLayerAndMount(),this.hudManager.mount(o)}return t.prototype.mount=function(t){document.querySelector(t).appendChild(this.viewportElement)},t.prototype.getCurrentLayer=function(){return this.layerManager.getCurrent()},t.prototype.setToolManager=function(t){this.toolManager=t},t.prototype.setCurrentTool=function(t){this.toolManager.setCurrentTool(t)},t.prototype.registerTool=function(t){this.toolManager.registerTool(t)},t.prototype.setSetting=function(t){this.setting=t},t.prototype.setCursor=function(t){this.svgRoot.style.cursor=t},t.prototype.setCommandManager=function(t){this.commandManager=t},t.prototype.executeCommand=function(t){for(var e,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];"undo"!==t?"redo"!==t?(e=this.commandManager).execute.apply(e,A([t],n)):this.commandManager.redo():this.commandManager.undo()},t.prototype.isContentElement=function(t){for(;t;){if(t.parentElement===this.svgContent)return!0;if(t.parentElement===this.svgRoot)return!1;t=t.parentElement}return!1},t}();var O=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function M(t,e){var n=e.get("fill"),o=e.get("stroke"),r=e.get("stroke-width");t.setAttr("fill",n),t.setAttr("stroke",o),t.setAttr("stroke-width",r)}var P=function(){function t(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this.editor=t}return t.prototype.afterRedo=function(){},t.prototype.afterUndo=function(){},t}(),N=function(t){function e(e,n,o,r,i){var s=t.call(this,e)||this,a=new l.Rect(n,o,r,i);return M(a,e.setting),e.getCurrentLayer().addChild(a),s.nextSibling=a.el().nextElementSibling,s.parent=a.el().parentElement,s.rect=a,s.editor.activedElsManager.setEls(s.rect),s}return O(e,t),e.cmdName=function(){return"addRect"},e.prototype.redo=function(){var t=this.rect.el();this.nextSibling?this.parent.insertBefore(t,this.nextSibling):this.parent.appendChild(t),this.editor.activedElsManager.setEls(this.rect)},e.prototype.undo=function(){this.rect.el().remove(),this.editor.activedElsManager.clear()},e}(P),k=function(t){function e(e,n){var o=t.call(this,e)||this,r=new l.Path;return M(r,e.setting),r.setAttr("d",n),e.getCurrentLayer().addChild(r),o.nextSibling=r.el().nextElementSibling,o.parent=r.el().parentElement,o.el=r,o.editor.activedElsManager.setEls(o.el),o}return O(e,t),e.cmdName=function(){return"addPath"},e.prototype.redo=function(){var t=this.el.el();this.nextSibling?this.parent.insertBefore(t,this.nextSibling):this.parent.appendChild(t),this.editor.activedElsManager.setEls(this.el)},e.prototype.undo=function(){this.el.el().remove(),this.editor.activedElsManager.clear()},e}(P),T=function(t){function e(e){var n=t.call(this,e)||this;n.els=n.editor.activedElsManager.getEls();var o=n.els.length;return n.parents=new Array(o),n.nextSiblings=new Array(o),n.els.forEach((function(t,e){n.nextSiblings[e]=t.el().nextElementSibling,n.parents[e]=t.el().parentElement})),n.execute(),n}return O(e,t),e.cmdName=function(){return"removeElements"},e.prototype.execute=function(){this.els.forEach((function(t){t.remove()})),this.editor.activedElsManager.clear()},e.prototype.redo=function(){this.execute()},e.prototype.undo=function(){for(var t=this.els.length-1;t>=0;t--){var e=this.els[t].el();this.nextSiblings[t]?this.parents[t].insertBefore(e,this.nextSiblings[t]):this.parents[t].appendChild(e)}this.editor.activedElsManager.setEls(this.els)},e}(P),L=function(t){function e(e,n,o,r){var i=t.call(this,e)||this;return i.dx=o,i.dy=r,i.els=n,i.els.forEach((function(t){t.dmove(i.dx,i.dy)})),i}return O(e,t),e.cmdName=function(){return"dmove"},e.prototype.redo=function(){var t=this;this.els.forEach((function(e){e.dmove(t.dx,t.dy)}))},e.prototype.undo=function(){var t=this;this.els.forEach((function(e){e.dmove(-t.dx,-t.dy)}))},e.prototype.afterRedo=function(){this.editor.activedElsManager.setEls(this.els)},e.prototype.afterUndo=function(){this.editor.activedElsManager.setEls(this.els)},e}(P),B=function(t){function e(e,n,o,r){var i=t.call(this,e)||this;return Array.isArray(n)||(n=[n]),i.els=n,i.attrName=o,i.beforeVal=i.els.map((function(t){return t.getAttr(o)})),i.afterVal=r,i.els.forEach((function(t){t.setAttr(o,r)})),i}return O(e,t),e.cmdName=function(){return"setAttr"},e.prototype.redo=function(){var t=this;this.els.forEach((function(e){e.setAttr(t.attrName,t.afterVal)}))},e.prototype.undo=function(){var t=this;this.els.forEach((function(e,n){e.setAttr(t.attrName,t.beforeVal[n])}))},e}(P),I=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),j=function(t){function e(e,n){var o=t.call(this,e)||this;if(o.els=void 0===n?e.activedElsManager.getEls():n,0===o.els.length)throw new Error("elements can not be empty.");o.nextSiblings=new Array(o.els.length);for(var r=0;r<o.els.length;r++){var i=o.els[r];o.nextSiblings[r]=i.nextSibling(),i.front()}return o}return I(e,t),e.cmdName=function(){return"front"},e.prototype.undo=function(){for(var t=this.els.length-1;t>=0;t--){var e=this.els[t],n=this.nextSiblings[t];null!==n&&e.before(n)}},e.prototype.redo=function(){for(var t=0;t<this.els.length;t++){this.els[t].front()}},e}(P),R=function(t){function e(e,n){var o=t.call(this,e)||this;if(o.els=void 0===n?e.activedElsManager.getEls():n,0===o.els.length)throw new Error("elements can not be empty.");o.previousSiblings=new Array(o.els.length);for(var r=o.els.length-1;r>=0;r--){var i=o.els[r];o.previousSiblings[r]=i.previousSibling()}return o.exec(),o}return I(e,t),e.cmdName=function(){return"back"},e.prototype.undo=function(){for(var t=this.els.length,e=0;e<t;e++){var n=this.els[e],o=this.previousSiblings[e];null!==o&&n.after(o)}},e.prototype.redo=function(){this.exec()},e.prototype.exec=function(){for(var t=this.els.length-1;t>=0;t--){this.els[t].back()}},e}(P),H=function(t){function e(e,n){var o=t.call(this,e)||this;if(o.els=void 0===n?e.activedElsManager.getEls():n,0===o.els.length)throw new Error("elements can not be empty.");return o.exec(),o}return I(e,t),e.cmdName=function(){return"forward"},e.prototype.exec=function(){for(var t=null,e=this.els.length-1;e>=0;e--){var n=this.els[e],o=n.el().nextElementSibling;null!==t&&o===t||o&&n.after(o),t=n.el()}},e.prototype.undo=function(){for(var t=null,e=0;e<this.els.length;e++){var n=this.els[e],o=n.el().previousElementSibling;null!==t&&o===t||o&&n.before(o),t=n.el()}},e.prototype.redo=function(){this.exec()},e}(P),D=function(t){function e(e,n){var o=t.call(this,e)||this;if(o.els=void 0===n?e.activedElsManager.getEls():n,0===o.els.length)throw new Error("elements can not be empty.");return o.exec(),o}return I(e,t),e.cmdName=function(){return"backward"},e.prototype.exec=function(){for(var t=null,e=0;e<this.els.length;e++){var n=this.els[e],o=n.el().previousElementSibling;null!==t&&o===t||o&&n.before(o),t=n.el()}},e.prototype.undo=function(){for(var t=null,e=this.els.length-1;e>=0;e--){var n=this.els[e],o=n.el().nextElementSibling;null!==t&&o===t||o&&n.after(o),t=n.el()}},e.prototype.redo=function(){this.exec()},e}(P),F=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var o=Array(t),r=0;for(e=0;e<n;e++)for(var i=arguments[e],s=0,a=i.length;s<a;s++,r++)o[r]=i[s];return o};const X=function(){function t(t){this.editor=t,this.redoStack=[],this.undoStack=[],this.commandClasses={},this.resigterCommandClass(N,N.cmdName()),this.resigterCommandClass(k,k.cmdName()),this.resigterCommandClass(L,L.cmdName()),this.resigterCommandClass(B,B.cmdName()),this.resigterCommandClass(T,T.cmdName()),this.resigterCommandClass(j,j.cmdName()),this.resigterCommandClass(R,R.cmdName()),this.resigterCommandClass(H,H.cmdName()),this.resigterCommandClass(D,D.cmdName())}return t.prototype.setEditor=function(t){this.editor=t},t.prototype.execute=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var o=this.commandClasses[t];if(!o)throw new Error("editor has not the "+t+" command");var r=new(o.bind.apply(o,F([void 0,this.editor],e)));this.undoStack.push(r),this.redoStack=[]},t.prototype.undo=function(){if(0!==this.undoStack.length){var t=this.undoStack.pop();this.redoStack.push(t),t.undo(),t.afterUndo()}else console.log("undo stack is empty, can not undo")},t.prototype.redo=function(){if(0!==this.redoStack.length){var t=this.redoStack.pop();this.undoStack.push(t),t.redo(),t.afterRedo()}else console.log("redo stack is empty, can not redo")},t.prototype.resigterCommandClass=function(t,e){this.commandClasses[e]=t},t.prototype.afterAnyUndo=function(){},t}();var Y=function(){function t(){this.setting={},this.bindedEventFns={},this.setFill("#fff"),this.setStroke("#000"),this.set("stroke-width","1px")}return t.prototype.setFill=function(t){this.set("fill",t)},t.prototype.setStroke=function(t){this.set("stroke",t)},t.prototype.set=function(t,e){this.setting[t]=e;var n=this.bindedEventFns[t];n&&n.forEach((function(t){t(e)}))},t.prototype.get=function(t){return this.setting[t]},t.prototype.bindEvent=function(t,e){this.bindedEventFns[t]||(this.bindedEventFns[t]=[]),this.bindedEventFns[t].push(e)},t}(),V=function(){function t(t,e){this.editor=t,this.mousePressed=!1,this.originEvent=e,this.isEndInside=!1,this.startX=0,this.startY=0,this.offsetX=0,this.offsetY=0,this.startClientX=0,this.startClientY=0,this.dx=0,this.dy=0,this.setStartPos()}return t.prototype.setOriginEvent=function(t){this.originEvent=t},t.prototype.setStartPos=function(){var t=this.getPos(),e=t.x,n=t.y;this.startX=e,this.startY=n,this.startClientX=this.originEvent.clientX,this.startClientY=this.originEvent.clientY},t.prototype.releaseMouse=function(){this.mousePressed=!1},t.prototype.pressMouse=function(){this.mousePressed=!0},t.prototype.getPos=function(){var t=this.editor.viewport.getZoom(),e=this.editor.viewport.getContentOffset(),n=e.x,o=e.y;return{x:this.originEvent.offsetX/t-n,y:this.originEvent.offsetY/t-o}},t.prototype.getStartPos=function(){return{x:this.startX,y:this.startY}},t.prototype.getDiffPos=function(){return{x:this.originEvent.clientX-this.startClientX,y:this.originEvent.clientY-this.startClientY}},t}();function z(t,e,n,o){var r=Math.abs(n-t),i=Math.abs(o-e);return{x:Math.min(n,t),y:Math.min(o,e),w:r,h:i}}var Z=function(){function t(){}return t.prototype.setEditor=function(t){this.editor=t},t}(),W=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();const q=function(t){function e(){var e=t.call(this)||this;return e.editor=null,e}return W(e,t),e.prototype.name=function(){return"addRect"},e.prototype.cursorNormal=function(){return"crosshair"},e.prototype.cursorPress=function(){return"crosshair"},e.prototype.start=function(){},e.prototype.move=function(t){var e=t.getPos(),n=e.x,o=e.y,r=t.getStartPos(),i=z(r.x,r.y,n,o),s=i.x,a=i.y,h=i.w,u=i.h;this.editor.hudManager.outlineBoxHud.drawRect(s,a,h,u)},e.prototype.end=function(t){this.editor.hudManager.outlineBoxHud.clear();var e=t.getPos(),n=e.x,o=e.y,r=t.getStartPos(),i=z(r.x,r.y,n,o),s=i.x,a=i.y,h=i.w,u=i.h;h<2&&u<2?console.log("width and height both less equal to 2，drawing nothing"):this.editor.executeCommand("addRect",s,a,h,u)},e.prototype.endOutside=function(){this.editor.hudManager.outlineBoxHud.clear()},e}(Z);var G=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),U=function(t){function e(){var e=t.call(this)||this;return e.startOffsetX=0,e.startOffsetY=0,e}return G(e,t),e.prototype.name=function(){return"dragCanvas"},e.prototype.cursorNormal=function(){return"grab"},e.prototype.cursorPress=function(){return"grabbing"},e.prototype.beforeActive=function(){},e.prototype.start=function(){var t=this.editor.viewport.getScroll();this.startOffsetX=t.x,this.startOffsetY=t.y},e.prototype.move=function(t){var e=t.getDiffPos(),n=e.x,o=e.y;this.editor.viewport.setScroll(this.startOffsetX-n,this.startOffsetY-o)},e.prototype.end=function(){},e.prototype.endOutside=function(){},e}(Z),K=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),J=function(t){function e(){var e=t.call(this)||this;return e.selectedEls=[],e.outlineStartX=0,e.outlineStartY=0,e}return K(e,t),e.prototype.name=function(){return"select"},e.prototype.cursorNormal=function(){return"default"},e.prototype.cursorPress=function(){return"default"},e.prototype.hasSelectedElsWhenStart=function(){return this.selectedEls.length>0},e.prototype.start=function(t){var e=t.originEvent.target;if(this.editor.isContentElement(e)){var n=l.create(e),o=this.editor.activedElsManager;o.contains(e)?o.heighligthEls():o.setEls(n),this.selectedEls=o.getEls();var r=this.editor.hudManager.outlineBoxHud;this.outlineStartX=r.getX(),this.outlineStartY=r.getY()}},e.prototype.move=function(t){if(this.hasSelectedElsWhenStart()){var e=t.getDiffPos(),n=e.x,o=e.y,r=this.editor.hudManager.outlineBoxHud,i=r.getWidth(),s=r.getHeight();r.drawRect(this.outlineStartX+n,this.outlineStartY+o,i,s)}else{var a=t.getPos(),h=a.x,u=a.y,c=t.getStartPos(),l=z(c.x,c.y,h,u),p=l.x,d=l.y,f=l.w,g=l.h;this.editor.hudManager.selectArea.drawRect(p,d,f,g)}},e.prototype.end=function(t){if(!this.hasSelectedElsWhenStart()){var e=this.editor.hudManager.selectArea.getBox();return this.editor.hudManager.selectArea.clear(),void this.editor.activedElsManager.setElsInBox(e)}this.editor.hudManager.outlineBoxHud.clear();var n=t.getDiffPos(),o=n.x,r=n.y;this.editor.executeCommand("dmove",this.selectedEls,o,r),this.editor.activedElsManager.setEls(this.selectedEls),this.selectedEls=[]},e.prototype.endOutside=function(){this.editor.hudManager.outlineBoxHud.clear(),this.editor.hudManager.selectArea.clear(),this.editor.activedElsManager.clear(),this.selectedEls=[]},e}(Z),Q=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),$=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Q(e,t),e.prototype.name=function(){return"pencil"},e.prototype.cursorNormal=function(){return"default"},e.prototype.cursorPress=function(){return"default"},e.prototype.start=function(t){console.log("pencil start");var e=t.getPos(),n=e.x,o=e.y;this.editor.hudManager.pencilDraw.addPoint(n,o)},e.prototype.move=function(t){var e=t.getPos(),n=e.x,o=e.y;this.editor.hudManager.pencilDraw.addPoint(n,o)},e.prototype.doWhenEndOrEndOutside=function(){var t=this.editor.hudManager.pencilDraw.getD();this.editor.hudManager.pencilDraw.clear(),this.editor.setting.set("fill","none"),this.editor.executeCommand("addPath",t)},e.prototype.end=function(){this.doWhenEndOrEndOutside()},e.prototype.endOutside=function(){this.doWhenEndOrEndOutside()},e}(Z);var tt,et=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();!function(t){t[t.DragHandle=0]="DragHandle",t[t.DrawPoint=1]="DrawPoint"}(tt||(tt={}));var nt=function(t){function e(){var e=t.call(this)||this;return e.state=tt.DrawPoint,e.isInit=!0,e.editor=null,e.state=tt.DrawPoint,e}return et(e,t),e.prototype.name=function(){return"addPath"},e.prototype.cursorNormal=function(){return"default"},e.prototype.cursorPress=function(){return"default"},e.prototype.start=function(t){var e=t.getPos(),n=e.x,o=e.y;this.x=n,this.y=o,this.editor.hudManager.pathDraw.addSeg({x:n,y:o,handleIn:null,handleOut:null})},e.prototype.move=function(t){var e,n,o,r=t.getPos(),i=(e=r,n=this.x,o=this.y,{x:2*n-e.x,y:2*o-e.y});this.editor.hudManager.pathDraw.updateTailSegHandle(i,r)},e.prototype.end=function(){},e.prototype.endOutside=function(){},e}(Z),ot=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),rt=function(t){function e(){var e=t.call(this)||this;return e.editor=null,e}return ot(e,t),e.prototype.name=function(){return"zoom"},e.prototype.cursorNormal=function(){return"zoom-in"},e.prototype.cursorPress=function(){return"zoom-in"},e.prototype.start=function(t){var e=t.getPos(),n=e.x,o=e.y;this.editor.viewport.zoomIn(n,o)},e.prototype.move=function(t){},e.prototype.end=function(t){},e.prototype.endOutside=function(t){},e}(Z),it=function(){function t(t){this.editor=t,this.tools={},this.currentTool=null,this.invokeWhenSwitch=function(){},this.ctx=null,this.registerTool(new q),this.registerTool(new U),this.registerTool(new J),this.registerTool(new $),this.registerTool(new nt),this.registerTool(new rt)}return t.prototype.setCurrentTool=function(t){this.currentTool=this.tools[t];var e=this.currentTool.cursorNormal();this.editor.setCursor(e);var n=this.getCurrentToolName();this.invokeWhenSwitch(n)},t.prototype.onSwitchTool=function(t){this.invokeWhenSwitch=t},t.prototype.getCurrentToolName=function(){return this.currentTool.name()},t.prototype.registerTool=function(t){this.tools[t.name()]=t,t.setEditor(this.editor)},t.prototype.bindToolEvent=function(){var t=this,e=this.editor.svgRoot;e.addEventListener("mousedown",(function(e){var n=new V(t.editor,e);t.ctx=n;var o=t.currentTool.cursorPress();t.editor.setCursor(o),t.currentTool.start(n)}),!1),e.addEventListener("mousemove",(function(e){var n=t.ctx;n&&(n.setOriginEvent(e),n.pressMouse(),t.currentTool.move(n))}),!1),e.addEventListener("mouseup",(function(e){var n=t.ctx,o=t.currentTool.cursorNormal();t.editor.setCursor(o),t.currentTool.end(n),n.isEndInside=!0}),!1),window.addEventListener("mouseup",(function(){t.ctx&&!1===t.ctx.isEndInside&&t.currentTool.endOutside(t.ctx),t.ctx=null}),!1)},t}();var st=new _;window.editor=st;var at=new X(st);st.setCommandManager(at),st.setSetting(new Y);var ht=new it(st);function ut(t,e){document.querySelector(t).onclick=e}st.setToolManager(ht),st.toolManager.onSwitchTool((function(t){console.log("switched tool:",t),function(t){var e={select:"btn-select",addRect:"btn-add-rect",dragCanvas:"btn-drag-canvas",pencil:"btn-pencil",addPath:"btn-add-path",zoom:"btn-zoom"}[t];if(void 0!==t){var n=document.querySelector("#tool-bar");Array.prototype.slice.call(n.children).forEach((function(t){t.classList.remove("active")})),document.getElementById(e).classList.add("active")}}(t)})),ht.setCurrentTool("addPath"),ht.bindToolEvent(),st.mount("#editor-area"),st.viewport.center(),ut("#btn-undo",(function(){st.executeCommand("undo")})),ut("#btn-redo",(function(){st.executeCommand("redo")})),ut("#btn-zoom-in",(function(){st.viewport.zoomIn()})),ut("#btn-zoom-out",(function(){st.viewport.zoomOut()})),ut("#btn-add-rect",(function(){st.setCurrentTool("addRect")})),ut("#btn-drag-canvas",(function(){st.setCurrentTool("dragCanvas")})),ut("#btn-pencil",(function(){st.setCurrentTool("pencil")})),ut("#btn-add-path",(function(){st.setCurrentTool("addPath")})),ut("#btn-select",(function(){st.setCurrentTool("select")})),ut("#btn-zoom",(function(){st.setCurrentTool("zoom")})),ut("#btn-delete",(function(){st.activedElsManager.isNoEmpty()&&st.executeCommand("removeElements")})),ut("#btn-front",(function(){st.activedElsManager.isNoEmpty()&&st.executeCommand("front")})),ut("#btn-forward",(function(){st.activedElsManager.isNoEmpty()&&st.executeCommand("forward")})),ut("#btn-backward",(function(){st.activedElsManager.isNoEmpty()&&st.executeCommand("backward")})),ut("#btn-back",(function(){st.activedElsManager.isNoEmpty()&&st.executeCommand("back")}));var ct=document.querySelector("#element-info-fill");ct.innerHTML=st.setting.get("fill"),st.setting.bindEvent("fill",(function(t){ct.innerHTML=t})),ut("#set-fill-btn",(function(){var t=window.prompt("Please input valid color value（like #ffce43）",st.setting.get("fill"));t&&(ct.innerHTML=t,st.setting.setFill(t),st.activedElsManager.setElsAttr("fill",t))}));var lt=document.querySelector("#element-info-stroke");lt.innerHTML=st.setting.get("stroke"),st.setting.bindEvent("stroke",(function(t){lt.innerHTML=t})),ut("#set-stroke-btn",(function(){var t=window.prompt("Please input valid color value（like #ffce43）",st.setting.get("stroke"));t&&(lt.innerHTML=t,st.setting.setStroke(t),st.activedElsManager.setElsAttr("stroke",t))}));var pt=document.querySelector("#element-info-stroke-width");pt.innerHTML=st.setting.get("stroke-width"),st.setting.bindEvent("stroke-width",(function(t){pt.innerHTML=t})),ut("#set-stroke-width-btn",(function(){var t=window.prompt("Please input value(like 6px)",st.setting.get("stroke-width"));t&&(pt.innerHTML=t,st.setting.set("stroke-width",t),st.activedElsManager.setElsAttr("stroke-width",t))})),st.shortcut.register("Undo","Cmd+Z",(function(){st.executeCommand("undo")})),st.shortcut.register("Undo","Ctrl+Z",(function(){st.executeCommand("undo")})),st.shortcut.register("Redo","Cmd+Shift+Z",(function(){st.executeCommand("redo")})),st.shortcut.register("Redo","Ctrl+Shift+Z",(function(){st.executeCommand("redo")})),st.shortcut.register("Delete","Backspace",(function(){st.activedElsManager.isNoEmpty()&&st.executeCommand("removeElements")})),document.querySelector("#shortcut").innerHTML=st.shortcut.formatPrint()})();